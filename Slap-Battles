local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Function to create the GUI
local function createGUI()
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "HalloweenGUI"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.Parent = playerGui

    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0, 300, 0, 400)
    MainFrame.Position = UDim2.new(0.5, -150, 0.5, -200)
    MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    MainFrame.BorderSizePixel = 0
    MainFrame.Parent = ScreenGui

    -- Make the frame draggable
    MainFrame.Active = true
    MainFrame.Draggable = true
    MainFrame.Selectable = true

    local uiCorner = Instance.new("UICorner")
    uiCorner.CornerRadius = UDim.new(0, 10)
    uiCorner.Parent = MainFrame

    local uiStroke = Instance.new("UIStroke")
    uiStroke.Color = Color3.fromRGB(255, 120, 0)
    uiStroke.Thickness = 2
    uiStroke.Parent = MainFrame

    local Title = Instance.new("TextLabel")
    Title.Name = "Title"
    Title.Size = UDim2.new(1, -40, 0, 30)
    Title.Position = UDim2.new(0, 0, 0, 10)
    Title.Font = Enum.Font.GothamBold
    Title.Text = "üéÉ[HALLOWEEN] Slap Battlesüëè"
    Title.TextColor3 = Color3.fromRGB(255, 120, 0)
    Title.TextSize = 18
    Title.BackgroundTransparency = 1
    Title.Parent = MainFrame

    -- Close button
    local CloseButton = Instance.new("TextButton")
    CloseButton.Name = "CloseButton"
    CloseButton.Size = UDim2.new(0, 30, 0, 30)
    CloseButton.Position = UDim2.new(1, -35, 0, 5)
    CloseButton.Font = Enum.Font.GothamBold
    CloseButton.Text = "X"
    CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    CloseButton.TextSize = 18
    CloseButton.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
    CloseButton.BorderSizePixel = 0
    CloseButton.Parent = MainFrame

    local closeCorner = Instance.new("UICorner")
    closeCorner.CornerRadius = UDim.new(0, 8)
    closeCorner.Parent = CloseButton

    CloseButton.MouseButton1Click:Connect(function()
        MainFrame.Visible = false
    end)

    local ButtonsFrame = Instance.new("Frame")
    ButtonsFrame.Name = "ButtonsFrame"
    ButtonsFrame.Size = UDim2.new(1, -20, 1, -100)
    ButtonsFrame.Position = UDim2.new(0, 10, 0, 50)
    ButtonsFrame.BackgroundTransparency = 1
    ButtonsFrame.Parent = MainFrame

    local function createModernButton(name, position)
        local button = Instance.new("TextButton")
        button.Name = name
        button.Size = UDim2.new(1, 0, 0, 40)
        button.Position = position
        button.Font = Enum.Font.GothamSemibold
        button.Text = name
        button.TextColor3 = Color3.fromRGB(255, 255, 255)
        button.TextSize = 14
        button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
        button.BorderSizePixel = 0
        button.TextWrapped = true
        button.Parent = ButtonsFrame

        local uiCorner = Instance.new("UICorner")
        uiCorner.CornerRadius = UDim.new(0, 8)
        uiCorner.Parent = button

        local uiStroke = Instance.new("UIStroke")
        uiStroke.Color = Color3.fromRGB(255, 120, 0)
        uiStroke.Thickness = 1
        uiStroke.Parent = button

        button.MouseEnter:Connect(function()
            TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 80, 80)}):Play()
        end)

        button.MouseLeave:Connect(function()
            TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(60, 60, 60)}):Play()
        end)

        return button
    end

    local button1 = createModernButton("üç¨ Collect Candy v1", UDim2.new(0, 0, 0, 0))
    button1.MouseButton1Click:Connect(function()
        print("Collect Candy v1 clicked")
        loadstring(game:HttpGet("https://pastebin.com/raw/f8xygc7f"))()
    end)

    local button2 = createModernButton("üç≠ Collect Candy v2", UDim2.new(0, 0, 0, 50))
    button2.MouseButton1Click:Connect(function()
        loadstring(game:HttpGet("https://pastebin.com/raw/fUPSf0GB"))()
    end)

    local button3 = createModernButton("üßü Slap Aura (Zombies)", UDim2.new(0, 0, 0, 100))
    button3.MouseButton1Click:Connect(function()
        loadstring(game:HttpGet("https://pastebin.com/raw/cPVD2sha"))()
    end)

    local button4 = createModernButton("üéÉ Go to Event Area", UDim2.new(0, 0, 0, 150))
    button4.MouseButton1Click:Connect(function()
        -- Get the player's character
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()

-- Teleport the character to the specified coordinates
character:SetPrimaryPartCFrame(CFrame.new(429, 360, 20))

    end)

    local button5 = createModernButton("üõ°Ô∏è Safe Zone", UDim2.new(0, 0, 0, 200))
    button5.MouseButton1Click:Connect(function()
        -- Get the player's character
local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()

-- Teleport the character to the specified coordinates
character:SetPrimaryPartCFrame(CFrame.new(-13, 10, -266))

    end)

    local button6 = createModernButton("üîÑ Rejoin", UDim2.new(0, 0, 0, 250))
    button6.MouseButton1Click:Connect(function()
        local teleportService = game:GetService("TeleportService") -- TeleportService
local localPlayer = game:GetService("Players").LocalPlayer -- LocalPlayer

-- Function to rejoin the server
teleportService:Teleport(game.PlaceId, localPlayer) -- Rejoin to the same server

    end)

    local CreditText = Instance.new("TextLabel")
    CreditText.Name = "CreditText"
    CreditText.Size = UDim2.new(1, 0, 0, 20)
    CreditText.Position = UDim2.new(0, 0, 1, -25)
    CreditText.Font = Enum.Font.GothamSemibold
    CreditText.Text = "Made by geeky blox"
    CreditText.TextColor3 = Color3.fromRGB(200, 200, 200)
    CreditText.TextSize = 12
    CreditText.BackgroundTransparency = 1
    CreditText.Parent = MainFrame

    -- Add a simple fade-in animation
    MainFrame.Transparency = 1
    for i = 1, 10 do
        MainFrame.Transparency = 1 - (i * 0.1)
        wait(0.02)
    end

    return ScreenGui
end

-- Create the GUI initially
local gui = createGUI()

-- Create a ScreenGui for the toggle button
local toggleGui = Instance.new("ScreenGui")
toggleGui.Name = "ToggleGUI"
toggleGui.ResetOnSpawn = false
toggleGui.Parent = playerGui

local toggleButton = Instance.new("TextButton")
toggleButton.Name = "ToggleButton"
toggleButton.Size = UDim2.new(0, 40, 0, 40)
toggleButton.Position = UDim2.new(0, 10, 0.5, -20)
toggleButton.Font = Enum.Font.GothamBold
toggleButton.Text = "üéÉ"
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.TextSize = 24
toggleButton.BackgroundColor3 = Color3.fromRGB(255, 120, 0)
toggleButton.BorderSizePixel = 0
toggleButton.Parent = toggleGui

local toggleCorner = Instance.new("UICorner")
toggleCorner.CornerRadius = UDim.new(0, 20)
toggleCorner.Parent = toggleButton

toggleButton.MouseButton1Click:Connect(function()
    gui.MainFrame.Visible = not gui.MainFrame.Visible
end)

-- Function to ensure GUI persistence
local function onCharacterAdded(character)
    if not playerGui:FindFirstChild("HalloweenGUI") then
        gui = createGUI()
    end
    if not playerGui:FindFirstChild("ToggleGUI") then
        toggleGui.Parent = playerGui
    end
end

-- Connect the function to the CharacterAdded event
player.CharacterAdded:Connect(onCharacterAdded)

-- Run the function once to create the GUI if the character already exists
if player.Character then
    onCharacterAdded(player.Character)
end

-- Hotkey to toggle GUI visibility
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed and input.KeyCode == Enum.KeyCode.RightControl then
        gui.MainFrame.Visible = not gui.MainFrame.Visible
    end
end)
